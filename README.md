# 文档格式转换工具

这是一个多功能文档格式转换网页应用，支持PDF转Word、Markdown转Word等多种格式转换。

## 项目目标

- 提供简单易用的多种文档格式转换服务
- 保持原文档中的文本、图片和格式
- 提供良好的用户体验和转换状态反馈
- 支持多种文档格式之间的无缝转换

## 最新优化（2025年3月16日）

### Markdown转Word功能优化
1. **Pandoc集成**：使用Pandoc实现高质量Markdown到Word的转换
2. **自动安装检测**：自动检测并安装Pandoc，无需用户手动配置
3. **图片处理支持**：支持处理Markdown中的网络图片和本地图片
4. **代码高亮保留**：保留Markdown中的代码高亮效果
5. **数学公式支持**：支持MathML格式的数学公式转换

### 界面与用户体验优化
1. **添加刷新功能**：转换完成后可一键刷新，开始新的转换
2. **独立状态管理**：为每种转换类型维护独立状态，互不干扰
3. **优化日志管理**：将日志文件移至专门目录，提高系统稳定性
4. **增强文件清理**：改进临时文件清理机制，确保资源释放

### 后端优化
1. **移除高级模式选项**：默认始终使用高级模式进行PDF转Word转换，提供最佳转换效果
2. **自动清理临时文件**：下载完成后自动清理临时文件，无需用户手动操作
3. **优化文本框处理**：改进对多段落文本框的处理，保持原始格式
4. **修复文本框转表格问题**：防止文本框内容被错误识别为表格

### 前端优化
1. **简化用户界面**：移除高级模式开关，默认使用最佳转换设置
2. **移除清理按钮**：移除清理临时文件按钮，系统自动处理文件清理
3. **更新提示信息**：更新底部信息，明确说明文件将在下载后自动删除
4. **优化用户体验**：下载成功后提示用户文件将在自动清理

## 支持的转换类型

1. **PDF转Word**：将PDF文档转换为可编辑的Word文档
2. **Markdown转Word**：将Markdown文件转换为格式化的Word文档
3. **Word转PDF**（即将推出）：将Word文档转换为PDF格式
4. **PDF转Markdown**（即将推出）：将PDF文档转换为Markdown格式

## 技术架构

### 前端
- Vue3
- Element Plus
- Axios
- FileSaver.js

### 后端
- Python 3.13.2
- FastAPI
- pdfplumber
- python-docx
- pdf2image
- pdf2docx
- pypandoc
- requests

## 功能特点

1. **文件上传**
   - 支持拖拽/点击上传（最大20MB）
   - 格式验证（支持.pdf和.md文件）
   - 即时显示文件信息

2. **PDF转Word功能**
   - 文本提取与格式保留
   - 图片提取与插入
   - 表格结构保留
   - 文本框多段落支持
   - 转换进度实时显示

3. **Markdown转Word功能**
   - 代码块高亮保留
   - 数学公式支持
   - 自动生成目录
   - 图片自动下载与嵌入
   - 自定义样式模板

4. **安全与性能**
   - 文件类型验证
   - 异步任务处理
   - 自动清理临时文件
   - 独立日志管理

## 使用方法

1. 选择转换类型（PDF转Word或Markdown转Word）
2. 选择或拖拽文件到上传区域
3. 点击"开始转换"按钮
4. 等待转换完成后，点击"下载文件"按钮获取转换后的文档
5. 如需进行新的转换，点击"刷新"按钮重置界面

## 安装与部署

### 环境要求
- Python 3.10+
- Node.js 16+
- Pandoc 3.0+（Markdown转Word功能需要）

### 后端安装
```bash
cd backend
pip install -r requirements.txt
```

### 前端安装
```bash
cd frontend
npm install
```

### 启动服务
```bash
# 启动后端
cd backend
python -m uvicorn main:app --reload

# 启动前端
cd frontend
npm run dev
```

## 待办事项

1. ✅ Markdown转Word功能
2. ⏳ Word转PDF功能
3. ⏳ PDF转Markdown功能
4. ⏳ 优化PDF中代码块转换问题

## 贡献指南

欢迎提交问题报告和功能请求。如果您想贡献代码，请先创建issue讨论您想要更改的内容。

## 许可证

本项目采用MIT许可证。详情请参阅LICENSE文件。



